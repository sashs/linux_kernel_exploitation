obj-m := vuln1.o
KDIR := /lib/modules/$(shell uname -r)/build
PWD := $(shell pwd)

# Don't create .text.unlikely/.text.hot sections.
EXTRA_CFLAGS += -fno-reorder-functions

# Disable stack protector to allow exploiting stack buffer overflows.
EXTRA_CFLAGS += -fno-stack-protector

EXTRA_CFLAGS += -g -DDEBUG
ccflags-y += ${EXTRA_CFLAGS}
CC += ${EXTRA_CFLAGS}

default:
	$(MAKE) -C $(KDIR) M=$(PWD) SUBDIRS=$(PWD) modules

clean:
	$(MAKE) -C $(KDIR) M=$(PWD) SUBDIRS=$(PWD) clean
